
<!DOCTYPE html>

<html lang="es">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Mandatum - Generador de Poderes Jur√≠dicos</title>
<script src="https://cdn.tailwindcss.com">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js">
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js">
</script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&amp;family=Playfair+Display:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/>
<style>
        body {
            background-color: #f0f4f8;
            font-family: 'Cormorant Garamond', serif;
        }
        .app-container {
            font-family: 'Cormorant Garamond', serif;
        }
        .logo-container {
            max-width: 150px;
            max-height: 80px;
        }
        .logo-preview {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        .document-preview {
            font-family: 'Times New Roman', Times, serif;
            line-height: 1.6;
        }
        .signature-line {
            border-top: 1px solid black;
            width: 200px;
            display: inline-block;
            margin-top: 50px;
        }
        .signature-container {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }
        .signature-block {
            width: 45%;
            text-align: center;
        }
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .toggle-slider {
            background-color: #0a3161;
        }
        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }
        [contenteditable="true"]:focus {
            outline: 2px solid #0a3161;
            padding: 2px;
        }
        .btn-primary {
            background-color: #0a3161;
            color: white;
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            background-color: #051d3b;
        }
        .btn-secondary {
            background-color: #8b0000;
            color: white;
            transition: all 0.3s ease;
        }
        .btn-secondary:hover {
            background-color: #6b0000;
        }
        .btn-tertiary {
            background-color: #003366;
            color: white;
            transition: all 0.3s ease;
        }
        .btn-tertiary:hover {
            background-color: #002244;
        }
        .header-gradient {
            background-color: #0a3161;
            height: 180px; /* Increased header height */
        }
        .preview-actions {
            position: sticky;
            top: 0;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: 10;
            padding: 10px;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        .tooltip {
            position: relative;
            display: inline-block;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 140px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 5px;
            position: absolute;
            z-index: 1;
            bottom: 150%;
            left: 50%;
            margin-left: -70px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .tooltip .tooltiptext::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #555 transparent transparent transparent;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        /* Toast notification */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 20px;
            border-radius: 4px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            opacity: 0;
            transform: translateY(-20px);
        }
        .toast.success {
            background-color: #4caf50;
        }
        .toast.error {
            background-color: #f44336;
        }
        .toast.info {
            background-color: #2196f3;
        }
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        /* Loading spinner */
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 4px solid white;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            vertical-align: middle;
            margin-right: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media print {
            body * {
                visibility: hidden;
            }
            #documentPreview, #documentPreview * {
                visibility: visible;
            }
            #documentPreview {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                font-family: 'Times New Roman', Times, serif !important;
            }
            .preview-actions {
                display: none;
            }
        }
        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1050;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
        }
        .modal-content {
            position: relative;
            background-color: #fefefe;
            margin: 2% auto;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
            width: 90%;
            max-width: 1200px;
            max-height: 90vh;
            overflow-y: auto;
        }
        .close-modal {
            position: absolute;
            top: 15px;
            right: 20px;
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        .close-modal:hover {
            color: #555;
        }
        .code-container {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-wrap;
            max-height: 70vh;
        }
        /* Responsive improvements */
        @media (max-width: 768px) {
            .header-gradient {
                height: auto;
                padding: 20px 10px;
            }
            .preview-actions {
                justify-content: center;
            }
            .preview-actions button {
                padding: 8px 12px;
                font-size: 0.875rem;
            }
            #documentPreview {
                padding: 15px !important;
                font-size: 14px !important;
            }
            .signature-line {
                width: 150px;
            }
            /* Keep signatures side by side even on mobile */
            .signature-container {
                display: flex;
                flex-direction: row;
                justify-content: space-between;
                width: 100%;
            }
            .signature-block {
                width: 45%;
            }
            .modal-content {
                width: 95%;
                margin: 5% auto;
            }
        }
    </style>
<style>*, ::before, ::after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgb(59 130 246 / 0.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/* ! tailwindcss v3.4.16 | MIT License | https://tailwindcss.com */*,::after,::before{box-sizing:border-box;border-width:0;border-style:solid;border-color:#e5e7eb}::after,::before{--tw-content:''}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;-moz-tab-size:4;tab-size:4;font-family:ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";font-feature-settings:normal;font-variation-settings:normal;-webkit-tap-highlight-color:transparent}body{margin:0;line-height:inherit}hr{height:0;color:inherit;border-top-width:1px}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;font-feature-settings:normal;font-variation-settings:normal;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{text-indent:0;border-color:inherit;border-collapse:collapse}button,input,optgroup,select,textarea{font-family:inherit;font-feature-settings:inherit;font-variation-settings:inherit;font-size:100%;font-weight:inherit;line-height:inherit;letter-spacing:inherit;color:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0;padding:0}legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::placeholder,textarea::placeholder{opacity:1;color:#9ca3af}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{max-width:100%;height:auto}[hidden]:where(:not([hidden=until-found])){display:none}.container{width:100%}@media (min-width: 640px){.container{max-width:640px}}@media (min-width: 768px){.container{max-width:768px}}@media (min-width: 1024px){.container{max-width:1024px}}@media (min-width: 1280px){.container{max-width:1280px}}@media (min-width: 1536px){.container{max-width:1536px}}.mx-auto{margin-left:auto;margin-right:auto}.mb-1{margin-bottom:0.25rem}.mb-2{margin-bottom:0.5rem}.mb-3{margin-bottom:0.75rem}.mb-4{margin-bottom:1rem}.mb-8{margin-bottom:2rem}.mr-1{margin-right:0.25rem}.mr-2{margin-right:0.5rem}.mt-1{margin-top:0.25rem}.mt-2{margin-top:0.5rem}.mt-3{margin-top:0.75rem}.mt-4{margin-top:1rem}.mt-6{margin-top:1.5rem}.block{display:block}.flex{display:flex}.grid{display:grid}.hidden{display:none}.h-4{height:1rem}.h-5{height:1.25rem}.min-h-\[600px\]{min-height:600px}.min-h-screen{min-height:100vh}.w-4{width:1rem}.w-5{width:1.25rem}.w-full{width:100%}.grid-cols-1{grid-template-columns:repeat(1, minmax(0, 1fr))}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-center{align-items:center}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-4{gap:1rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.space-y-4 > :not([hidden]) ~ :not([hidden]){--tw-space-y-reverse:0;margin-top:calc(1rem * calc(1 - var(--tw-space-y-reverse)));margin-bottom:calc(1rem * var(--tw-space-y-reverse))}.overflow-auto{overflow:auto}.rounded{border-radius:0.25rem}.rounded-lg{border-radius:0.5rem}.rounded-t-lg{border-top-left-radius:0.5rem;border-top-right-radius:0.5rem}.border{border-width:1px}.border-b{border-bottom-width:1px}.border-t{border-top-width:1px}.border-gray-300{--tw-border-opacity:1;border-color:rgb(209 213 219 / var(--tw-border-opacity, 1))}.bg-gray-100{--tw-bg-opacity:1;background-color:rgb(243 244 246 / var(--tw-bg-opacity, 1))}.bg-gray-700{--tw-bg-opacity:1;background-color:rgb(55 65 81 / var(--tw-bg-opacity, 1))}.bg-gray-800{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.bg-green-600{--tw-bg-opacity:1;background-color:rgb(22 163 74 / var(--tw-bg-opacity, 1))}.bg-purple-600{--tw-bg-opacity:1;background-color:rgb(147 51 234 / var(--tw-bg-opacity, 1))}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255 / var(--tw-bg-opacity, 1))}.p-2{padding:0.5rem}.p-4{padding:1rem}.p-6{padding:1.5rem}.p-8{padding:2rem}.px-3{padding-left:0.75rem;padding-right:0.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.py-1{padding-top:0.25rem;padding-bottom:0.25rem}.py-2{padding-top:0.5rem;padding-bottom:0.5rem}.pt-4{padding-top:1rem}.text-center{text-align:center}.text-2xl{font-size:1.5rem;line-height:2rem}.text-5xl{font-size:3rem;line-height:1}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:0.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.font-bold{font-weight:700}.font-medium{font-weight:500}.font-semibold{font-weight:600}.italic{font-style:italic}.text-blue-900{--tw-text-opacity:1;color:rgb(30 58 138 / var(--tw-text-opacity, 1))}.text-gray-300{--tw-text-opacity:1;color:rgb(209 213 219 / var(--tw-text-opacity, 1))}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128 / var(--tw-text-opacity, 1))}.text-gray-600{--tw-text-opacity:1;color:rgb(75 85 99 / var(--tw-text-opacity, 1))}.text-gray-700{--tw-text-opacity:1;color:rgb(55 65 81 / var(--tw-text-opacity, 1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255 / var(--tw-text-opacity, 1))}.shadow-inner{--tw-shadow:inset 0 2px 4px 0 rgb(0 0 0 / 0.05);--tw-shadow-colored:inset 0 2px 4px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color), 0 4px 6px -4px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color), 0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow)}.transition{transition-property:color, background-color, border-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-text-decoration-color, -webkit-backdrop-filter;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms}.duration-200{transition-duration:200ms}.hover\:bg-gray-800:hover{--tw-bg-opacity:1;background-color:rgb(31 41 55 / var(--tw-bg-opacity, 1))}.hover\:bg-green-700:hover{--tw-bg-opacity:1;background-color:rgb(21 128 61 / var(--tw-bg-opacity, 1))}.hover\:bg-purple-700:hover{--tw-bg-opacity:1;background-color:rgb(126 34 206 / var(--tw-bg-opacity, 1))}@media (min-width: 640px){.sm\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}.sm\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}}@media (min-width: 768px){.md\:grid-cols-3{grid-template-columns:repeat(3, minmax(0, 1fr))}.md\:p-6{padding:1.5rem}.md\:text-2xl{font-size:1.5rem;line-height:2rem}.md\:text-6xl{font-size:3.75rem;line-height:1}}@media (min-width: 1024px){.lg\:grid-cols-2{grid-template-columns:repeat(2, minmax(0, 1fr))}}</style>
</head>
<body>
<div class="min-h-screen app-container">
<!-- Toast notification container -->
<div class="toast" id="toast">
</div>
<!-- Header -->
<header class="header-gradient text-white p-8 shadow-lg flex flex-col justify-center items-center">
<h1 class="text-5xl md:text-6xl font-bold mb-4" style="font-family: 'Playfair Display', serif;">Mandatum</h1>
<p class="text-xl md:text-2xl">Generador de Poderes Jur√≠dicos</p>
</header>
<!-- Main Content -->
<main class="container mx-auto p-4 md:p-6">
<div class="bg-white rounded-lg shadow-md p-4 md:p-6 mb-8">
<h2 class="text-xl font-semibold mb-4 text-blue-900">Complete el formulario para generar su poder</h2>
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
<!-- Left Column - Form -->
<div>
<form class="space-y-4" id="powerForm">
<!-- Logo Upload -->
<div class="mb-4">
<label class="block text-gray-700 font-medium mb-2">Logo para el Documento</label>
<input accept="image/*" class="w-full p-2 border border-gray-300 rounded" id="logoUpload" type="file"/>
<p class="text-sm text-gray-500 mt-1">Tama√±o recomendado: 150x80px</p>
</div>
<!-- Tipo de Poder -->
<div>
<label class="block text-gray-700 font-medium mb-2">Tipo de Poder</label>
<select class="w-full p-2 border border-gray-300 rounded" id="powerType">
<option value="PODER ESPECIAL">Poder Especial</option>
<option value="PODER GENERAL">Poder General</option>
</select>
</div>
<!-- Entidad Destinataria -->
<div>
<label class="block text-gray-700 font-medium mb-2">Entidad Destinataria</label>
<select class="w-full p-2 border border-gray-300 rounded" id="entityType">
<option value="DIRECCI√ìN GENERAL DE INGRESOS">Direcci√≥n General de Ingresos</option>
<option value="MINISTERIO DE ECONOM√çA Y FINANZAS">Ministerio de Econom√≠a y Finanzas</option>
<option value="MINISTERIO DE COMERCIO E INDUSTRIAS">Ministerio de Comercio e Industrias</option>
<option value="AUTORIDAD NACIONAL DE ADUANAS">Autoridad Nacional de Aduanas</option>
<option value="REGISTRO P√öBLICO DE PANAM√Å">Registro P√∫blico de Panam√°</option>
<option value="MINISTERIO DE TRABAJO Y DESARROLLO LABORAL">Ministerio de Trabajo y Desarrollo Laboral</option>
<option value="AUTORIDAD NACIONAL DE TIERRAS">Autoridad Nacional de Tierras</option>
<option value="MINISTERIO DE SALUD">Ministerio de Salud</option>
<option value="MINISTERIO DE EDUCACI√ìN">Ministerio de Educaci√≥n</option>
<option value="AUTORIDAD DE PROTECCI√ìN AL CONSUMIDOR Y DEFENSA DE LA COMPETENCIA">Autoridad de Protecci√≥n al Consumidor y Defensa de la Competencia</option>
<option value="AUTORIDAD MAR√çTIMA DE PANAM√Å">Autoridad Mar√≠tima de Panam√°</option>
<option value="AUTORIDAD NACIONAL DE LOS SERVICIOS P√öBLICOS">Autoridad Nacional de los Servicios P√∫blicos</option>
<option value="TRIBUNAL ADMINISTRATIVO TRIBUTARIO">Tribunal Administrativo Tributario</option>
<option value="OTRO">Otro (Especificar)</option>
</select>
<input class="w-full p-2 border border-gray-300 rounded mt-2 hidden" id="customEntity" placeholder="Especifique la entidad" type="text"/>
</div>
<!-- Datos del Otorgante -->
<div class="border-t pt-4 mt-4">
<div class="flex justify-between items-center mb-3">
<h3 class="font-medium text-lg text-blue-900">Datos del Otorgante</h3>
<div class="flex items-center">
<span class="mr-2 text-sm text-gray-600">Aplicar</span>
<label class="toggle-switch">
<input checked="" id="granterToggle" type="checkbox"/>
<span class="toggle-slider">
</span>
</label>
</div>
</div>
<div id="granterFields">
<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
<div>
<label class="block text-gray-700 font-medium mb-1">Nombre Completo</label>
<input class="w-full p-2 border border-gray-300 rounded" id="granterName" placeholder="Ej: MARIA" type="text"/>
</div>
<div>
<label class="block text-gray-700 font-medium mb-1">C√©dula</label>
<input class="w-full p-2 border border-gray-300 rounded" id="granterID" placeholder="Ej: 8-88-888" type="text"/>
</div>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">G√©nero</label>
<select class="w-full p-2 border border-gray-300 rounded" id="granterGender">
<option value="mujer">Mujer</option>
<option value="var√≥n">Var√≥n</option>
</select>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Nacionalidad</label>
<input class="w-full p-2 border border-gray-300 rounded" id="granterNationality" placeholder="Ej: paname√±a" type="text" value="paname√±a"/>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Domicilio</label>
<textarea class="w-full p-2 border border-gray-300 rounded" id="granterAddress" placeholder="Ej: Provincia y Distrito de Panam√°, corregimiento de Bella Vista..." rows="2">
                                    </textarea>
</div>
<div class="mt-3">
<div class="flex justify-between items-center">
<label class="block text-gray-700 font-medium mb-1">Cargo</label>
<div class="flex items-center">
<span class="mr-2 text-sm text-gray-600">Aplicar</span>
<label class="toggle-switch">
<input checked="" id="granterPositionToggle" type="checkbox"/>
<span class="toggle-slider">
</span>
</label>
</div>
</div>
<input class="w-full p-2 border border-gray-300 rounded" id="granterPosition" placeholder="Ej: Presidente y Representante Legal" type="text"/>
</div>
</div>
</div>
<!-- Datos de la Empresa/Organizaci√≥n -->
<div class="border-t pt-4 mt-4">
<div class="flex justify-between items-center mb-3">
<h3 class="font-medium text-lg text-blue-900">Datos de la Empresa/Organizaci√≥n</h3>
<div class="flex items-center">
<span class="mr-2 text-sm text-gray-600">Aplicar</span>
<label class="toggle-switch">
<input checked="" id="companyToggle" type="checkbox"/>
<span class="toggle-slider">
</span>
</label>
</div>
</div>
<div id="companyFields">
<div>
<label class="block text-gray-700 font-medium mb-1">Nombre</label>
<input class="w-full p-2 border border-gray-300 rounded" id="companyName" placeholder="Ej: JUAN S.A." type="text"/>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Tipo de Organizaci√≥n</label>
<select class="w-full p-2 border border-gray-300 rounded" id="companyType">
<option value="Asociaci√≥n de Inter√©s P√∫blico">Asociaci√≥n de Inter√©s P√∫blico</option>
<option value="Sociedad An√≥nima">Sociedad An√≥nima</option>
<option value="Fundaci√≥n">Fundaci√≥n</option>
<option value="ONG">ONG</option>
<option value="Otro">Otro</option>
</select>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Folio/Registro</label>
<input class="w-full p-2 border border-gray-300 rounded" id="companyRegistry" placeholder="Ej: 250436355" type="text"/>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Domicilio</label>
<textarea class="w-full p-2 border border-gray-300 rounded" id="companyAddress" placeholder="Ej: Edificio San Bernardo, Plaza de Francia..." rows="2">
                                    </textarea>
</div>
</div>
</div>
<!-- Datos del Apoderado -->
<div class="border-t pt-4 mt-4">
<div class="flex justify-between items-center mb-3">
<h3 class="font-medium text-lg text-blue-900">Datos del Apoderado</h3>
<div class="flex items-center">
<span class="mr-2 text-sm text-gray-600">Aplicar</span>
<label class="toggle-switch">
<input checked="" id="attorneyToggle" type="checkbox"/>
<span class="toggle-slider">
</span>
</label>
</div>
</div>
<div id="attorneyFields">
<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
<div>
<label class="block text-gray-700 font-medium mb-1">Nombre Completo</label>
<input class="w-full p-2 border border-gray-300 rounded" id="attorneyName" placeholder="Ej: JUAN" type="text" value="JUAN"/>
</div>
<div>
<label class="block text-gray-700 font-medium mb-1">C√©dula</label>
<input class="w-full p-2 border border-gray-300 rounded" id="attorneyID" placeholder="Ej: 8-888-8888" type="text"/>
</div>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">G√©nero</label>
<select class="w-full p-2 border border-gray-300 rounded" id="attorneyGender">
<option value="var√≥n">Var√≥n</option>
<option value="mujer">Mujer</option>
</select>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Nacionalidad</label>
<input class="w-full p-2 border border-gray-300 rounded" id="attorneyNationality" placeholder="Ej: paname√±o" type="text" value="paname√±o"/>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Profesi√≥n</label>
<input class="w-full p-2 border border-gray-300 rounded" id="attorneyProfession" placeholder="Ej: abogado en ejercicio" type="text"/>
</div>
<div class="mt-3">
<div class="flex justify-between items-center">
<label class="block text-gray-700 font-medium mb-1">Cargo</label>
<div class="flex items-center">
<span class="mr-2 text-sm text-gray-600">Aplicar</span>
<label class="toggle-switch">
<input checked="" id="attorneyPositionToggle" type="checkbox"/>
<span class="toggle-slider">
</span>
</label>
</div>
</div>
<input class="w-full p-2 border border-gray-300 rounded" id="attorneyPosition" placeholder="Ej: Supervisor" type="text"/>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Correo Electr√≥nico</label>
<input class="w-full p-2 border border-gray-300 rounded" id="attorneyEmail" placeholder="correo@ejemplo.com" type="email"/>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Domicilio Profesional</label>
<textarea class="w-full p-2 border border-gray-300 rounded" id="attorneyAddress" placeholder="Ej: Casco Antiguo, Distrito y Provincia de Panam√°..." rows="2">
                                      </textarea>
</div>
<div class="mt-3">
<label class="block text-gray-700 font-medium mb-1">Tel√©fono</label>
<input class="w-full p-2 border border-gray-300 rounded" id="attorneyPhone" placeholder="Ej: 123-4567" type="text"/>
</div>
</div>
</div>
<!-- Objeto del Poder -->
<div class="border-t pt-4 mt-4">
<div class="flex justify-between items-center mb-3">
<h3 class="font-medium text-lg text-blue-900">Objeto del Poder</h3>
<div class="flex items-center">
<span class="mr-2 text-sm text-gray-600">Aplicar</span>
<label class="toggle-switch">
<input checked="" id="purposeToggle" type="checkbox"/>
<span class="toggle-slider">
</span>
</label>
</div>
</div>
<div id="purposeFields">
<div>
<label class="block text-gray-700 font-medium mb-1">Descripci√≥n del Objeto</label>
<textarea class="w-full p-2 border border-gray-300 rounded" id="powerPurpose" placeholder="Ej: presente y gestione, ante la Direcci√≥n General de Ingresos del Ministerio de Econom√≠a y Finanzas, la solicitud de autorizaci√≥n..." rows="4">
                                        </textarea>
</div>
</div>
</div>
<!-- Fecha -->
<div class="border-t pt-4 mt-4">
<div class="flex justify-between items-center mb-3">
<h3 class="font-medium text-lg text-blue-900">Fecha</h3>
<div class="flex items-center">
<span class="mr-2 text-sm text-gray-600">Aplicar</span>
<label class="toggle-switch">
<input checked="" id="dateToggle" type="checkbox"/>
<span class="toggle-slider">
</span>
</label>
</div>
</div>
<div id="dateFields">
<div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
<div>
<label class="block text-gray-700 font-medium mb-1">D√≠a</label>
<input class="w-full p-2 border border-gray-300 rounded" id="day" max="31" min="1" placeholder="D√≠a" type="number"/>
</div>
<div>
<label class="block text-gray-700 font-medium mb-1">Mes</label>
<select class="w-full p-2 border border-gray-300 rounded" id="month">
<option value="enero">Enero</option>
<option value="febrero">Febrero</option>
<option value="marzo">Marzo</option>
<option value="abril">Abril</option>
<option value="mayo">Mayo</option>
<option value="junio">Junio</option>
<option value="julio">Julio</option>
<option value="agosto">Agosto</option>
<option value="septiembre">Septiembre</option>
<option value="octubre">Octubre</option>
<option value="noviembre">Noviembre</option>
<option value="diciembre">Diciembre</option>
</select>
</div>
<div>
<label class="block text-gray-700 font-medium mb-1">A√±o</label>
<input class="w-full p-2 border border-gray-300 rounded" id="year" max="2050" min="2023" type="number" value="2025"/>
</div>
</div>
</div>
</div>
<!-- Botones -->
<div class="border-t pt-4 mt-6 flex flex-wrap gap-4">
<button class="btn-primary font-medium py-2 px-6 rounded-lg transition duration-200 flex items-center" id="generateBtn" type="button">
<svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
</path>
</svg>
                                    Generar Documento
                                </button>
<!-- Bot√≥n para ver el c√≥digo HTML -->

</div>
</form>
</div>
<!-- Right Column - Preview -->
<div>
<div class="bg-gray-100 rounded-lg border border-gray-300 shadow-inner">
<h3 class="text-lg font-medium p-4 text-center text-gray-700 border-b border-gray-300">Vista Previa del Documento</h3>
<!-- Preview Actions Bar -->
<div class="preview-actions rounded-t-lg">
<button class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center text-sm" id="copyBtn" type="button">
<svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
</path>
</svg>
                                    Copiar
                                </button>
<button class="btn-secondary font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center text-sm" id="downloadPdfBtn" type="button">
<svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
</path>
</svg>
                                    PDF
                                </button>
<button class="btn-tertiary font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center text-sm" id="downloadWordBtn" type="button">
<svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
</path>
</svg>
                                    Word
                                </button>
<button class="bg-gray-700 hover:bg-gray-800 text-white font-medium py-2 px-4 rounded-lg transition duration-200 flex items-center text-sm" id="printBtn" type="button">
<svg class="h-4 w-4 mr-1" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2">
</path>
</svg>
                                    Imprimir
                                </button>
</div>
<div class="document-preview bg-white p-8 border border-gray-300 min-h-[600px] text-sm overflow-auto" id="documentPreview" style="font-family: 'Times New Roman', Times, serif;">
<p class="text-gray-500 text-center italic">Complete el formulario y haga clic en "Generar Documento" para ver la vista previa.</p>
</div>
</div>
</div>
</div>
</div>
</main>
<!-- Footer -->
<footer class="bg-gray-800 text-white p-6">
<div class="container mx-auto">
<div class="grid grid-cols-1 md:grid-cols-3 gap-8">
<div>
<h3 class="text-lg font-semibold mb-3">Mandatum</h3>
<p class="text-gray-300">Herramienta para la creaci√≥n de documentos legales de representaci√≥n para tr√°mites en entidades p√∫blicas paname√±as.</p>
</div>
<div>
<h3 class="text-lg font-semibold mb-3">Informaci√≥n Legal</h3>
<p class="text-gray-300">Este generador crea documentos que deben ser revisados por un profesional del derecho antes de su uso oficial.</p>
<p class="text-gray-300 mt-2">Los documentos generados son plantillas y pueden requerir adaptaciones seg√∫n el caso espec√≠fico.</p>
</div>
<div>
<h3 class="text-lg font-semibold mb-3">Contacto</h3>
<p class="text-gray-300">Para consultas legales, contacte a un abogado especializado.</p>
<p class="text-gray-300 mt-2">¬© 2025 EBD. Todos los derechos reservados.</p>
<p class="text-gray-300 mt-2">Tel√©fono: +507 66846895</p>
<p class="text-gray-300">Email: estefania.bd17@gmail.com</p>
</div>
</div>
</div>
</footer>
<!-- Modal para mostrar el c√≥digo HTML -->
</div>
<script>
        document.addEventListener('DOMContentLoaded', function() {
            // Toast notification function
            function showToast(message, type = 'info') {
                const toast = document.getElementById('toast');
                toast.textContent = message;
                toast.className = `toast ${type}`;
                toast.classList.add('show');
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }
            
            // Function to send data to webhook
            async function sendToWebhook(data, documentType) {
                const webhookUrl = 'https://hook.us2.make.com/6y0qfi79gnbq93msg7d8or3tx9ikmaue';
                
                try {
                    showToast('Enviando datos al servidor...', 'info');
                    
                    const response = await fetch(webhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            documentType: documentType,
                            documentData: data,
                            timestamp: new Date().toISOString()
                        })
                    });
                    
                    if (response.ok) {
                        showToast('Datos enviados correctamente', 'success');
                        return true;
                    } else {
                        console.error('Error al enviar al webhook:', await response.text());
                        showToast('Error al enviar datos. Descargando localmente...', 'error');
                        return false;
                    }
                } catch (error) {
                    console.error('Error al enviar al webhook:', error);
                    showToast('Error de conexi√≥n. Descargando localmente...', 'error');
                    return false;
                }
            }
            
            // Collect form data for webhook
            function collectFormData() {
                return {
                    powerType: document.getElementById('powerType').value,
                    entity: document.getElementById('entityType').value === 'OTRO' ? 
                            document.getElementById('customEntity').value : 
                            document.getElementById('entityType').value,
                    granter: {
                        name: document.getElementById('granterName').value,
                        id: document.getElementById('granterID').value,
                        gender: document.getElementById('granterGender').value,
                        nationality: document.getElementById('granterNationality').value,
                        address: document.getElementById('granterAddress').value,
                        position: document.getElementById('granterPosition').value
                    },
                    company: {
                        name: document.getElementById('companyName').value,
                        type: document.getElementById('companyType').value,
                        registry: document.getElementById('companyRegistry').value,
                        address: document.getElementById('companyAddress').value
                    },
                    attorney: {
                        name: document.getElementById('attorneyName').value,
                        id: document.getElementById('attorneyID').value,
                        gender: document.getElementById('attorneyGender').value,
                        nationality: document.getElementById('attorneyNationality').value,
                        profession: document.getElementById('attorneyProfession').value,
                        position: document.getElementById('attorneyPosition').value,
                        email: document.getElementById('attorneyEmail').value,
                        address: document.getElementById('attorneyAddress').value,
                        phone: document.getElementById('attorneyPhone').value
                    },
                    purpose: document.getElementById('powerPurpose').value,
                    date: {
                        day: document.getElementById('day').value,
                        month: document.getElementById('month').value,
                        year: document.getElementById('year').value
                    },
                    documentContent: document.getElementById('documentPreview').innerHTML
                };
            }
            
            // Logo upload handling
            const logoUpload = document.getElementById('logoUpload');
            let logoData = null;
            
            logoUpload.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        logoData = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
            
            // Custom entity field toggle
            const entityType = document.getElementById('entityType');
            const customEntity = document.getElementById('customEntity');
            
            entityType.addEventListener('change', function() {
                if (this.value === 'OTRO') {
                    customEntity.classList.remove('hidden');
                } else {
                    customEntity.classList.add('hidden');
                }
            });
            
            // Toggle fields visibility
            const toggles = {
                'granterToggle': 'granterFields',
                'companyToggle': 'companyFields',
                'attorneyToggle': 'attorneyFields',
                'purposeToggle': 'purposeFields',
                'dateToggle': 'dateFields'
            };
            
            Object.keys(toggles).forEach(toggleId => {
                const toggle = document.getElementById(toggleId);
                const fieldsId = toggles[toggleId];
                const fields = document.getElementById(fieldsId);
                
                toggle.addEventListener('change', function() {
                    if (this.checked) {
                        fields.classList.remove('hidden');
                    } else {
                        fields.classList.add('hidden');
                    }
                });
            });
            
            // Position toggles
            const granterPositionToggle = document.getElementById('granterPositionToggle');
            const granterPosition = document.getElementById('granterPosition');
            const attorneyPositionToggle = document.getElementById('attorneyPositionToggle');
            const attorneyPosition = document.getElementById('attorneyPosition');
            
            granterPositionToggle.addEventListener('change', function() {
                granterPosition.disabled = !this.checked;
                granterPosition.classList.toggle('bg-gray-100', !this.checked);
            });
            
            attorneyPositionToggle.addEventListener('change', function() {
                attorneyPosition.disabled = !this.checked;
                attorneyPosition.classList.toggle('bg-gray-100', !this.checked);
            });
            
            // Update nationality based on gender
            const granterGender = document.getElementById('granterGender');
            const granterNationality = document.getElementById('granterNationality');
            const attorneyGender = document.getElementById('attorneyGender');
            const attorneyNationality = document.getElementById('attorneyNationality');
            
            granterGender.addEventListener('change', function() {
                granterNationality.value = this.value === 'mujer' ? 'paname√±a' : 'paname√±o';
            });
            
            attorneyGender.addEventListener('change', function() {
                attorneyNationality.value = this.value === 'mujer' ? 'paname√±a' : 'paname√±o';
            });
            
            // Generate document
            const generateBtn = document.getElementById('generateBtn');
            const documentPreview = document.getElementById('documentPreview');
            
            generateBtn.addEventListener('click', function() {
                // Get form values
                const powerType = document.getElementById('powerType').value;
                let entity = document.getElementById('entityType').value;
                if (entity === 'OTRO') {
                    entity = document.getElementById('customEntity').value || 'Entidad';
                }
                
                // Check which sections are enabled
                const granterEnabled = document.getElementById('granterToggle').checked;
                const companyEnabled = document.getElementById('companyToggle').checked;
                const attorneyEnabled = document.getElementById('attorneyToggle').checked;
                const purposeEnabled = document.getElementById('purposeToggle').checked;
                const dateEnabled = document.getElementById('dateToggle').checked;
                const granterPositionEnabled = document.getElementById('granterPositionToggle').checked;
                const attorneyPositionEnabled = document.getElementById('attorneyPositionToggle').checked;
                
                // Get values from enabled sections
                let granterName = '', granterID = '', granterGenderValue = '', granterNationalityValue = '', granterAddress = '', granterPosition = '';
                if (granterEnabled) {
                    granterName = document.getElementById('granterName').value || '[Nombre del Otorgante]';
                    granterID = document.getElementById('granterID').value || '[C√©dula]';
                    granterGenderValue = document.getElementById('granterGender').value;
                    granterNationalityValue = document.getElementById('granterNationality').value || (granterGenderValue === 'mujer' ? 'paname√±a' : 'paname√±o');
                    granterAddress = document.getElementById('granterAddress').value || '[Domicilio]';
                    if (granterPositionEnabled) {
                        granterPosition = document.getElementById('granterPosition').value || '[Cargo]';
                    }
                }
                
                let companyName = '', companyType = '', companyRegistry = '', companyAddress = '';
                if (companyEnabled) {
                    companyName = document.getElementById('companyName').value || '[Nombre de la Empresa]';
                    companyType = document.getElementById('companyType').value;
                    companyRegistry = document.getElementById('companyRegistry').value || '[Registro]';
                    companyAddress = document.getElementById('companyAddress').value || '[Domicilio de la Empresa]';
                }
                
                let attorneyName = '', attorneyID = '', attorneyGenderValue = '', attorneyNationalityValue = '', attorneyProfession = '', 
                    attorneyPosition = '', attorneyEmail = '', attorneyAddress = '', attorneyPhone = '';
                if (attorneyEnabled) {
                    attorneyName = document.getElementById('attorneyName').value || '[Nombre del Apoderado]';
                    attorneyID = document.getElementById('attorneyID').value || '[C√©dula]';
                    attorneyGenderValue = document.getElementById('attorneyGender').value;
                    attorneyNationalityValue = document.getElementById('attorneyNationality').value || (attorneyGenderValue === 'mujer' ? 'paname√±a' : 'paname√±o');
                    attorneyProfession = document.getElementById('attorneyProfession').value || '[Profesi√≥n]';
                    if (attorneyPositionEnabled) {
                        attorneyPosition = document.getElementById('attorneyPosition').value || '[Cargo]';
                    }
                    attorneyEmail = document.getElementById('attorneyEmail').value || '[Email]';
                    attorneyAddress = document.getElementById('attorneyAddress').value || '[Domicilio Profesional]';
                    attorneyPhone = document.getElementById('attorneyPhone').value || '[Tel√©fono]';
                }
                
                let powerPurpose = '';
                if (purposeEnabled) {
                    powerPurpose = document.getElementById('powerPurpose').value || '[Objeto del Poder]';
                }
                
                let dateText = '';
                if (dateEnabled) {
                    const day = document.getElementById('day').value || '__';
                    const month = document.getElementById('month').value;
                    const year = document.getElementById('year').value || '2025';
                    dateText = `Panam√°, ${day} de ${month} del ${year}.`;
                } else {
                    dateText = 'Panam√°, __ de ________ del ____.';
                }
                
                // Generate document HTML with proper gender pronouns
                let documentHTML = `
                    <div class="mb-4">
                        ${logoData ? `<img src="${logoData}" alt="Logo" style="max-height: 80px; max-width: 150px; margin-bottom: 20px;">` : ''}
                        <div class="text-center">
                                    <h2 class="text-xl font-bold" contenteditable="true">${powerType}</h2>
                                  </div>
                                </div>
                                <div class="mb-8">
                                  <p class="font-bold" contenteditable="true">SE√ëORES ${entity}</p>
                                </div>
                `;
                
                // Build the document body based on enabled sections
                let bodyText = '';
                
                if (granterEnabled) {
                    bodyText += `Quien suscribe, ${granterName}, ${granterGenderValue}, ${granterNationalityValue}, mayor de edad, ${granterGenderValue === 'mujer' ? 'portadora' : 'portador'} de la c√©dula de identidad personal No. ${granterID}, con domicilio ubicado en ${granterAddress}`;
                    
                    if (granterPositionEnabled && companyEnabled) {
                        bodyText += `, ${granterPosition} de ${companyName}, ${companyType} denominada ${companyName}, con personer√≠a jur√≠dica debidamente reconocida e inscrita al Folio No. ${companyRegistry} en el Registro P√∫blico de Panam√°, con domicilio en ${companyAddress}, acudo respetuosamente ante su despacho en calidad de ${granterPosition} del ${companyName}`;
                    } else if (companyEnabled) {
                        bodyText += `, de ${companyName}, ${companyType} denominada ${companyName}, con personer√≠a jur√≠dica debidamente reconocida e inscrita al Folio No. ${companyRegistry} en el Registro P√∫blico de Panam√°, con domicilio en ${companyAddress}, acudo respetuosamente ante su despacho`;
                    }
                    
                    if (attorneyEnabled) {
                        bodyText += `, con el objeto de Otorgar ${powerType} amplio y suficiente como en derecho se requiere ${attorneyGenderValue === 'mujer' ? 'a la Licenciada' : 'al Licenciado'} ${attorneyName}, ${attorneyGenderValue}, ${attorneyNationalityValue}, mayor de edad, ${attorneyGenderValue === 'mujer' ? 'portadora' : 'portador'} de la c√©dula de identidad personal No. ${attorneyID}, ${attorneyProfession}`;
                        
                        if (attorneyPositionEnabled) {
                            bodyText += `, ${attorneyPosition} ${companyEnabled ? `del ${companyName}` : ''}`;
                        }
                        
                        bodyText += `, con correo electr√≥nico ${attorneyEmail} y con domicilio profesional ubicado en ${attorneyAddress}, localizable en los tel√©fonos ${attorneyPhone}, donde recibe notificaciones personales`;
                        
                        if (purposeEnabled) {
                            bodyText += `, para que, en representaci√≥n ${companyEnabled ? 'de la asociaci√≥n' : 'del otorgante'}, ${powerPurpose}.`;
                        } else {
                            bodyText += '.';
                        }
                    } else {
                        bodyText += '.';
                    }
                }
                
                if (attorneyEnabled && !bodyText.includes(attorneyName)) {
                    bodyText += `\n\nSe otorga ${powerType} ${attorneyGenderValue === 'mujer' ? 'a la Licenciada' : 'al Licenciado'} ${attorneyName}, ${attorneyGenderValue}, ${attorneyNationalityValue}, mayor de edad, ${attorneyGenderValue === 'mujer' ? 'portadora' : 'portador'} de la c√©dula de identidad personal No. ${attorneyID}, ${attorneyProfession}`;
                    
                    if (purposeEnabled) {
                        bodyText += `, para que ${powerPurpose}.`;
                    } else {
                        bodyText += '.';
                    }
                }
                
                if (attorneyEnabled) {
                    bodyText += `\n\n${attorneyGenderValue === 'mujer' ? 'La Licenciada' : 'El Licenciado'} ${attorneyName}, queda expresamente ${attorneyGenderValue === 'mujer' ? 'facultada' : 'facultado'} para recibir, notificarse, solicitar, subsanar, obtener copias, comprometer, allanarse, desistir, transigir e interponer los recursos y acciones legales que estime conveniente para el mejor desempe√±o del presente mandato.`;
                }
                
                documentHTML += `
                    <div class="mb-8">
                                <p style="white-space: pre-line; font-family: 'Times New Roman', Times, serif;" contenteditable="true">${bodyText}</p>
                              </div>
                              <div class="mb-12">
                                <p contenteditable="true">${dateText}</p>
                              </div>
                `;
                
                // Add signatures - using the signature-container class to ensure side-by-side layout
                documentHTML += `
                    <div class="signature-container mt-16">
                              <div class="signature-block">
                                <p class="font-bold mb-16" contenteditable="true">OTORGO ${powerType}</p>
                                <div class="signature-line">
                                </div>
                                <p class="font-bold mt-2" contenteditable="true">${granterEnabled ? granterName : '____________________'}</p>
                                <p contenteditable="true">C.I.P. No. ${granterEnabled ? granterID : '____________________'}</p>
                              </div>
                              <div class="signature-block">
                                <p class="font-bold mb-16" contenteditable="true">ACEPTO ${powerType}</p>
                                <div class="signature-line">
                                </div>
                                <p class="font-bold mt-2" contenteditable="true">${attorneyEnabled ? attorneyName : '____________________'}</p>
                                <p contenteditable="true">C.I.P. No. ${attorneyEnabled ? attorneyID : '____________________'}</p>
                              </div>
                            </div>
                `;
                
                // Update preview
                documentPreview.innerHTML = documentHTML;
                
                // Enable export buttons
                document.getElementById('downloadPdfBtn').disabled = false;
                document.getElementById('downloadWordBtn').disabled = false;
                document.getElementById('printBtn').disabled = false;
                document.getElementById('copyBtn').disabled = false;
                
                showToast('Documento generado correctamente', 'success');
            });
            
            // Copy to clipboard
            const copyBtn = document.getElementById('copyBtn');
            
            copyBtn.addEventListener('click', function() {
                // Check if document has been generated
                if (documentPreview.innerHTML.includes('Complete el formulario')) {
                    showToast('Por favor, genere el documento primero.', 'error');
                    return;
                }
                
                // Create a clone of the preview for copying
                const printContent = documentPreview.cloneNode(true);
                
                // Remove contenteditable attribute for copying
                const editableElements = printContent.querySelectorAll('[contenteditable="true"]');
                editableElements.forEach(el => {
                    el.removeAttribute('contenteditable');
                });
                
                // Select the content
                const range = document.createRange();
                range.selectNode(printContent);
                window.getSelection().removeAllRanges();
                window.getSelection().addRange(range);
                
                // Copy to clipboard
                try {
                    document.execCommand('copy');
                    showToast('¬°Documento copiado al portapapeles!', 'success');
                } catch (err) {
                    showToast('No se pudo copiar el contenido. Por favor, int√©ntelo de nuevo.', 'error');
                }
                
                // Clear selection
                window.getSelection().removeAllRanges();
            });
            
            // Download as PDF with webhook integration
            const downloadPdfBtn = document.getElementById('downloadPdfBtn');
            
            downloadPdfBtn.addEventListener('click', async function() {
                // Check if document has been generated
                if (documentPreview.innerHTML.includes('Complete el formulario')) {
                    showToast('Por favor, genere el documento primero.', 'error');
                    return;
                }
                
                // Disable button and show loading state
                const originalBtnText = downloadPdfBtn.innerHTML;
                downloadPdfBtn.disabled = true;
                downloadPdfBtn.innerHTML = `<div class="spinner">
                          </div> Procesando...`;
                
                try {
                    // First send data to webhook
                    const formData = collectFormData();
                    await sendToWebhook(formData, 'PDF');
                    
                    // Create a clone of the preview for PDF generation
                    const printContent = documentPreview.cloneNode(true);
                    
                    // Remove contenteditable attribute for PDF generation
                    const editableElements = printContent.querySelectorAll('[contenteditable="true"]');
                    editableElements.forEach(el => {
                        el.removeAttribute('contenteditable');
                    });
                    
                    printContent.style.width = '100%';
                    printContent.style.height = 'auto';
                    printContent.style.padding = '40px';
                    printContent.style.fontFamily = "'Times New Roman', Times, serif";
                    
                    // Ensure signatures are side by side in PDF
                    const signatureContainer = printContent.querySelector('.signature-container');
                    if (signatureContainer) {
                        signatureContainer.style.display = 'flex';
                        signatureContainer.style.justifyContent = 'space-between';
                        signatureContainer.style.width = '100%';
                        
                        const signatureBlocks = signatureContainer.querySelectorAll('.signature-block');
                        signatureBlocks.forEach(block => {
                            block.style.width = '45%';
                            block.style.textAlign = 'center';
                        });
                    }
                    
                    // Temporarily append the clone to the document for html2canvas
                    printContent.style.position = 'absolute';
                    printContent.style.left = '-9999px';
                    document.body.appendChild(printContent);
                    
                    // Use html2canvas to capture the document as an image
                    const canvas = await html2canvas(printContent, {
                        scale: 2,
                        useCORS: true,
                        logging: false
                    });
                    
                    // Remove the temporary element
                    document.body.removeChild(printContent);
                    
                    const imgData = canvas.toDataURL('image/png');
                    
                    // Create PDF
                    const { jsPDF } = window.jspdf;
                    const pdf = new jsPDF('p', 'mm', 'a4');
                    
                    // Calculate dimensions
                    const imgWidth = 210; // A4 width in mm
                    const pageHeight = 297; // A4 height in mm
                    const imgHeight = canvas.height * imgWidth / canvas.width;
                    let heightLeft = imgHeight;
                    let position = 0;
                    
                    // Add first page
                    pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                    heightLeft -= pageHeight;
                    
                    // Add subsequent pages if needed
                    while (heightLeft > 0) {
                        position = heightLeft - imgHeight;
                        pdf.addPage();
                        pdf.addImage(imgData, 'PNG', 0, position, imgWidth, imgHeight);
                        heightLeft -= pageHeight;
                    }
                    
                    // Get document title
                    const powerType = document.getElementById('powerType').value;
                    const companyName = document.getElementById('companyName').value || 'Documento';
                    
                    // Save PDF
                    pdf.save(`${powerType} - ${companyName}.pdf`);
                    
                    showToast('PDF generado y datos enviados correctamente', 'success');
                } catch (error) {
                    console.error('Error al generar PDF:', error);
                    showToast('Error al generar PDF. Por favor, int√©ntelo de nuevo.', 'error');
                } finally {
                    // Restore button state
                    downloadPdfBtn.disabled = false;
                    downloadPdfBtn.innerHTML = originalBtnText;
                }
            });
            
            // Download as Word with webhook integration
            const downloadWordBtn = document.getElementById('downloadWordBtn');
            
            downloadWordBtn.addEventListener('click', async function() {
                // Check if document has been generated
                if (documentPreview.innerHTML.includes('Complete el formulario')) {
                    showToast('Por favor, genere el documento primero.', 'error');
                    return;
                }
                
                // Disable button and show loading state
                const originalBtnText = downloadWordBtn.innerHTML;
                downloadWordBtn.disabled = true;
                downloadWordBtn.innerHTML = `<div class="spinner">
                        </div> Procesando...`;
                
                try {
                    // First send data to webhook
                    const formData = collectFormData();
                    await sendToWebhook(formData, 'Word');
                    
                    // Create a clone of the preview for Word generation
                    const printContent = documentPreview.cloneNode(true);
                    
                    // Remove contenteditable attribute for Word generation
                    const editableElements = printContent.querySelectorAll('[contenteditable="true"]');
                    editableElements.forEach(el => {
                        el.removeAttribute('contenteditable');
                    });
                    
                    // Get document content with logo
                    let content = printContent.innerHTML;
                    
                    // Create header with styles
                    const header = `
                        <html xmlns:o='urn:schemas-microsoft-com:office:office' 
                              xmlns:w='urn:schemas-microsoft-com:office:word' 
                              xmlns='http://www.w3.org/TR/REC-html40'>
                        <head>
                          <meta charset="utf-8">
                          <title>Poder Jur√≠dico</title>
                          <style>
                                body { font-family: 'Times New Roman', Times, serif; }
                                .signature-line { border-top: 1px solid black; width: 200px; display: inline-block; }
                                .signature-container { display: flex; justify-content: space-between; width: 100%; }
                                .signature-block { width: 45%; text-align: center; }
                            </style>
                        </head>
                        <body>
                    `;
                    
                    // Create footer
                    const footer = `
                            <p style="text-align: center; margin-top: 50px;">¬© 2025. Mandatum - Generador de Poderes Jur√≠dicos. Todos los derechos reservados.</p>
                      </body>
                      </html>
                    `;
                    
                    // Combine all parts
                    const sourceHTML = header + content + footer;
                    
                    // Convert to Blob
                    const blob = new Blob(['\ufeff', sourceHTML], {type:'application/msword'});
                    
                    // Create download link
                    const powerType = document.getElementById('powerType').value;
                    const companyName = document.getElementById('companyName').value || 'Documento';
                    
                    // Use FileSaver.js for more reliable downloads
                    saveAs(blob, `${powerType} - ${companyName}.doc`);
                    
                    showToast('Word generado y datos enviados correctamente', 'success');
                } catch (error) {
                    console.error('Error al generar Word:', error);
                    showToast('Error al generar Word. Por favor, int√©ntelo de nuevo.', 'error');
                } finally {
                    // Restore button state
                    downloadWordBtn.disabled = false;
                    downloadWordBtn.innerHTML = originalBtnText;
                }
            });
            
            // Print document
            const printBtn = document.getElementById('printBtn');
            
            printBtn.addEventListener('click', function() {
                // Check if document has been generated
                if (documentPreview.innerHTML.includes('Complete el formulario')) {
                    showToast('Por favor, genere el documento primero.', 'error');
                    return;
                }
                
                window.print();
            });
            
            // Update nationality when gender changes
            document.getElementById('granterGender').addEventListener('change', function() {
                document.getElementById('granterNationality').value = this.value === 'mujer' ? 'paname√±a' : 'paname√±o';
            });
            
            document.getElementById('attorneyGender').addEventListener('change', function() {
                document.getElementById('attorneyNationality').value = this.value === 'mujer' ? 'paname√±a' : 'paname√±o';
            });
            
            // Set current date as default
            const today = new Date();
            document.getElementById('day').value = today.getDate();
            document.getElementById('month').selectedIndex = today.getMonth();
            document.getElementById('year').value = today.getFullYear();
            
            // Modal functionality for viewing HTML code
            const modal = document.getElementById('codeModal');
            const viewCodeBtn = document.getElementById('viewCodeBtn');
            const closeModal = document.getElementById('closeModal');
            const htmlCode = document.getElementById('htmlCode');
            const copyCodeBtn = document.getElementById('copyCodeBtn');
            
            // Get the HTML code of the entire page
            function getFullHtmlCode() {
                // Create a clone of the document
                const docClone = document.documentElement.cloneNode(true);
                
                // Remove the modal content to avoid recursion
                const modalElement = docClone.querySelector('#codeModal');
                if (modalElement) {
                    modalElement.parentNode.removeChild(modalElement);
                }
                
                // Get the HTML as string
                const htmlContent = '<!DOCTYPE html>\n' + docClone.outerHTML;
                
                // Format the HTML with indentation for better readability
                return formatHtml(htmlContent);
            }
            
            // Simple HTML formatter
            function formatHtml(html) {
                let formatted = '';
                let indent = '';
                
                // Split the HTML into lines
                const lines = html.split(/>\s*</);
                
                // Process each line
                lines.forEach((line, index) => {
                    // Add < and > back except for the first and last lines
                    if (index === 0) {
                        formatted += line;
                    } else {
                        // Check if this is a closing tag
                        if (line.indexOf('/') === 0 && line.indexOf('/>') === -1) {
                            indent = indent.substring(2); // Decrease indent
                        }
                        
                        formatted += '>\n' + indent + '<' + line;
                        
                        // Check if this is an opening tag and not a self-closing tag
                        if (line.indexOf('/') === -1 && line.indexOf('/>') === -1 && 
                            !line.startsWith('!DOCTYPE') && !line.startsWith('meta') && 
                            !line.startsWith('link') && !line.startsWith('br') && 
                            !line.startsWith('hr') && !line.startsWith('img') && 
                            !line.startsWith('input')) {
                            indent += '  '; // Increase indent
                        }
                    }
                });
                
                return formatted;
            }
            
            // Open modal with HTML code
            viewCodeBtn.addEventListener('click', function() {
                htmlCode.textContent = getFullHtmlCode();
                modal.style.display = 'block';
            });
            
            // Close modal
            closeModal.addEventListener('click', function() {
                modal.style.display = 'none';
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', function(event) {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
            
            // Copy HTML code
            copyCodeBtn.addEventListener('click', function() {
                const codeText = htmlCode.textContent;
                
                // Create a temporary textarea element to copy from
                const textarea = document.createElement('textarea');
                textarea.value = codeText;
                textarea.style.position = 'fixed'; // Avoid scrolling to bottom
                document.body.appendChild(textarea);
                textarea.select();
                
                try {
                    document.execCommand('copy');
                    showToast('¬°C√≥digo HTML copiado al portapapeles!', 'success');
                } catch (err) {
                    showToast('No se pudo copiar el c√≥digo. Por favor, int√©ntelo de nuevo.', 'error');
                }
                
                document.body.removeChild(textarea);
            });
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'94bf51a95413a54e',t:'MTc0OTI5MDU5OS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
<iframe height="1" style="position: absolute; top: 0px; left: 0px; border: medium; visibility: hidden;" width="1">
</iframe>
</body>
</html>